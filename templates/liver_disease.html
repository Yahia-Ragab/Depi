<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liver Disease Prediction | HealthPredictor</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Skip link for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Navigation -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="{{ url_for('index') }}" class="navbar-logo">
                <i class="fas fa-heartbeat"></i>
                <span>HealthPredictor</span>
            </a>
            
            <button class="navbar-mobile-toggle" aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button>
            
            <div class="navbar-links">
                <a href="{{ url_for('index') }}" class="navbar-link">Home</a>
                <a href="{{ url_for('liver_disease') }}" class="navbar-link active">Liver Disease</a>
                <a href="{{ url_for('length_of_stay') }}" class="navbar-link">Length of Stay</a>
                <a href="{{ url_for('diabetes') }}" class="navbar-link">Diabetes</a>
                <a href="#" class="navbar-link">About</a>
            </div>
        </div>
    </nav>
    
    <!-- Mobile Navigation -->
    <div class="navbar-mobile">
        <button class="navbar-mobile-close" aria-label="Close navigation">
            <i class="fas fa-times"></i>
        </button>
        <div class="navbar-mobile-links">
            <a href="{{ url_for('index') }}" class="navbar-mobile-link">Home</a>
            <a href="{{ url_for('liver_disease') }}" class="navbar-mobile-link active">Liver Disease</a>
            <a href="{{ url_for('length_of_stay') }}" class="navbar-mobile-link">Length of Stay</a>
            <a href="{{ url_for('diabetes') }}" class="navbar-mobile-link">Diabetes</a>
            <a href="#" class="navbar-mobile-link">About</a>
        </div>
    </div>
    
    <main id="main-content">
        <div class="container">
            <!-- Breadcrumbs -->
            <ul class="breadcrumbs">
                <li class="breadcrumb-item">
                    <a href="{{ url_for('index') }}" class="breadcrumb-link">Home</a>
                </li>
                <li class="breadcrumb-item active">
                    <span class="breadcrumb-link">Liver Disease Prediction</span>
                </li>
            </ul>
            
            <!-- Header -->
            <div class="page-header">
                <h1>Liver Disease Prediction</h1>
                <p>Enter patient information to predict the likelihood of liver disease</p>
            </div>
            
            <!-- Multi-step Form -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Patient Data Input</h2>
                    <p class="card-subtitle">Please complete all fields for an accurate prediction</p>
                </div>
                
                <!-- Form Steps Navigation -->
                <div class="form-steps">
                    <div class="form-step active" data-step="1">
                        <div class="step-number">1</div>
                        <div class="step-title">Patient Info</div>
                    </div>
                    <div class="form-step" data-step="2">
                        <div class="step-number">2</div>
                        <div class="step-title">Clinical Signs</div>
                    </div>
                    <div class="form-step" data-step="3">
                        <div class="step-number">3</div>
                        <div class="step-title">Lab Results</div>
                    </div>
                    <div class="form-step" data-step="4">
                        <div class="step-number">4</div>
                        <div class="step-title">Review</div>
                    </div>
                </div>
                
                <form method="POST" action="{{ url_for('liver_disease') }}" id="liver-disease-form">
                    <!-- Step 1: Patient Information -->
                    <div class="form-section" id="step-1">
                        <h3 class="form-section-title">Patient Information</h3>
                        
                        <div class="form-row">
                            <div class="form-col">
                                <label for="n_days">Number of Days</label>
                                <div class="input-group">
                                    <input type="number" id="n_days" name="n_days" placeholder="Enter number of days" step="1" min="0" required>
                                    <span class="input-addon">days</span>
                                </div>
                                <span class="input-help">Duration since diagnosis or first symptoms</span>
                            </div>
                            
                            <div class="form-col">
                                <label for="drug">Treatment Drug</label>
                                <div class="input-group">
                                    <select id="drug" name="drug" required>
                                        <option value="" disabled selected>Select drug...</option>
                                        <option value="0">Placebo</option>
                                        <option value="1">D-penicillamine</option>
                                    </select>
                                    <div class="input-icon">
                                        <i class="fas fa-prescription-bottle-medical"></i>
                                    </div>
                                </div>
                                <span class="input-help">Current medication regimen</span>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-col">
                                <label for="age">
                                    Age
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle tooltip-icon"></i>
                                        <span class="tooltip-text">Enter age in days, will be converted to years for analysis</span>
                                    </span>
                                </label>
                                <div class="input-group">
                                    <input type="number" id="age" name="age" placeholder="Enter age in days" step="1" min="0" required>
                                    <span class="input-addon">days</span>
                                </div>
                            </div>
                            
                            <div class="form-col">
                                <label for="sex">Biological Sex</label>
                                <div class="input-group">
                                    <select id="sex" name="sex" required>
                                        <option value="" disabled selected>Select sex...</option>
                                        <option value="0">Female</option>
                                        <option value="1">Male</option>
                                    </select>
                                    <div class="input-icon">
                                        <i class="fas fa-venus-mars"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Step 2: Clinical Signs -->
                    <div class="form-section" id="step-2" style="display: none;">
                        <h3 class="form-section-title">Clinical Signs & Symptoms</h3>
                        
                        <div class="form-row">
                            <div class="form-col">
                                <label for="ascites">
                                    Ascites
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle tooltip-icon"></i>
                                        <span class="tooltip-text">Abnormal buildup of fluid in the abdomen</span>
                                    </span>
                                </label>
                                <div class="input-group">
                                    <select id="ascites" name="ascites" required>
                                        <option value="" disabled selected>Select ascites status...</option>
                                        <option value="0">No</option>
                                        <option value="1">Yes</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-col">
                                <label for="hepatomegaly">
                                    Hepatomegaly
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle tooltip-icon"></i>
                                        <span class="tooltip-text">Enlarged liver</span>
                                    </span>
                                </label>
                                <div class="input-group">
                                    <select id="hepatomegaly" name="hepatomegaly" required>
                                        <option value="" disabled selected>Select hepatomegaly status...</option>
                                        <option value="0">No</option>
                                        <option value="1">Yes</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-col">
                                <label for="spiders">
                                    Spider Angiomas
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle tooltip-icon"></i>
                                        <span class="tooltip-text">Spider-like blood vessels visible on skin</span>
                                    </span>
                                </label>
                                <div class="input-group">
                                    <select id="spiders" name="spiders" required>
                                        <option value="" disabled selected>Select spiders status...</option>
                                        <option value="0">No</option>
                                        <option value="1">Yes</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-col">
                                <label for="edema">
                                    Edema
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle tooltip-icon"></i>
                                        <span class="tooltip-text">Swelling caused by fluid retention</span>
                                    </span>
                                </label>
                                <div class="input-group">
                                    <select id="edema" name="edema" required>
                                        <option value="" disabled selected>Select edema status...</option>
                                        <option value="0">No (N)</option>
                                        <option value="1">Slight (S)</option>
                                        <option value="2">Yes (Y)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-col">
                                <label for="stage">
                                    Disease Stage
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle tooltip-icon"></i>
                                        <span class="tooltip-text">Clinical staging of liver disease progression</span>
                                    </span>
                                </label>
                                <div class="input-group">
                                    <input type="number" id="stage" name="stage" placeholder="Enter stage (1-3)" step="1" min="1" max="3" required>
                                </div>
                                <span class="input-help">Stage ranges from 1 (mild) to 3 (severe)</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Step 3: Laboratory Results -->
                    <div class="form-section" id="step-3" style="display: none;">
                        <h3 class="form-section-title">Laboratory Results</h3>
                        
                        <div class="form-row">
                            <div class="form-col">
                                <label for="bilirubin">
                                    Bilirubin
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle tooltip-icon"></i>
                                        <span class="tooltip-text">Normal range: 0.3-1.0 mg/dL</span>
                                    </span>
                                </label>
                                <div class="input-group">
                                    <input type="number" id="bilirubin" name="bilirubin" placeholder="Enter bilirubin level" step="any" required>
                                    <span class="input-addon">mg/dL</span>
                                </div>
                            </div>
                            
                            <div class="form-col">
                                <label for="cholesterol">
                                    Cholesterol
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle tooltip-icon"></i>
                                        <span class="tooltip-text">Normal range: 125-200 mg/dL</span>
                                    </span>
                                </label>
                                <div class="input-group">
                                    <input type="number" id="cholesterol" name="cholesterol" placeholder="Enter cholesterol level" step="any" required>
                                    <span class="input-addon">mg/dL</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-col">
                                <label for="albumin">
                                    Albumin
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle tooltip-icon"></i>
                                        <span class="tooltip-text">Normal range: 3.5-5.0 g/dL</span>
                                    </span>
                                </label>
                                <div class="input-group">
                                    <input type="number" id="albumin" name="albumin" placeholder="Enter albumin level" step="any" required>
                                    <span class="input-addon">g/dL</span>
                                </div>
                            </div>
                            
                            <div class="form-col">
                                <label for="copper">
                                    Copper
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle tooltip-icon"></i>
                                        <span class="tooltip-text">Normal range: 70-175 µg/dL</span>
                                    </span>
                                </label>
                                <div class="input-group">
                                    <input type="number" id="copper" name="copper" placeholder="Enter copper level" step="any" required>
                                    <span class="input-addon">µg/dL</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-col">
                                <label for="alk_phos">
                                    Alk_Phos
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle tooltip-icon"></i>
                                        <span class="tooltip-text">Alkaline Phosphatase, normal range: 44-147 U/L</span>
                                    </span>
                                </label>
                                <div class="input-group">
                                    <input type="number" id="alk_phos" name="alk_phos" placeholder="Enter Alk_Phos level" step="any" required>
                                    <span class="input-addon">U/L</span>
                                </div>
                            </div>
                            
                            <div class="form-col">
                                <label for="sgot">
                                    SGOT
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle tooltip-icon"></i>
                                        <span class="tooltip-text">Aspartate Aminotransferase, normal range: 5-40 U/L</span>
                                    </span>
                                </label>
                                <div class="input-group">
                                    <input type="number" id="sgot" name="sgot" placeholder="Enter SGOT level" step="any" required>
                                    <span class="input-addon">U/L</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-col">
                                <label for="tryglicerides">
                                    Triglycerides
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle tooltip-icon"></i>
                                        <span class="tooltip-text">Normal range: <150 mg/dL</span>
                                    </span>
                                </label>
                                <div class="input-group">
                                    <input type="number" id="tryglicerides" name="tryglicerides" placeholder="Enter triglycerides level" step="any" required>
                                    <span class="input-addon">mg/dL</span>
                                </div>
                            </div>
                            
                            <div class="form-col">
                                <label for="platelets">
                                    Platelets
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle tooltip-icon"></i>
                                        <span class="tooltip-text">Normal range: 150,000-450,000 per µL</span>
                                    </span>
                                </label>
                                <div class="input-group">
                                    <input type="number" id="platelets" name="platelets" placeholder="Enter platelets count" step="any" required>
                                    <span class="input-addon">per µL</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-col">
                                <label for="prothrombin">
                                    Prothrombin Time
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle tooltip-icon"></i>
                                        <span class="tooltip-text">Normal range: 11-13.5 seconds</span>
                                    </span>
                                </label>
                                <div class="input-group">
                                    <input type="number" id="prothrombin" name="prothrombin" placeholder="Enter prothrombin time" step="any" required>
                                    <span class="input-addon">seconds</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Step 4: Review -->
                    <div class="form-section" id="step-4" style="display: none;">
                        <h3 class="form-section-title">Review Patient Information</h3>
                        
                        <div class="alert alert-info">
                            <div class="alert-icon">
                                <i class="fas fa-info-circle"></i>
                            </div>
                            <div class="alert-content">
                                <div class="alert-title">Verify Information</div>
                                <p>Please review all entered data for accuracy before submitting. The prediction quality depends on the accuracy of input data.</p>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-col">
                                <h4>Patient Information</h4>
                                <p><strong>Days:</strong> <span id="review-days"></span></p>
                                <p><strong>Drug:</strong> <span id="review-drug"></span></p>
                                <p><strong>Age:</strong> <span id="review-age"></span> days</p>
                                <p><strong>Sex:</strong> <span id="review-sex"></span></p>
                            </div>
                            
                            <div class="form-col">
                                <h4>Clinical Signs</h4>
                                <p><strong>Ascites:</strong> <span id="review-ascites"></span></p>
                                <p><strong>Hepatomegaly:</strong> <span id="review-hepatomegaly"></span></p>
                                <p><strong>Spider Angiomas:</strong> <span id="review-spiders"></span></p>
                                <p><strong>Edema:</strong> <span id="review-edema"></span></p>
                                <p><strong>Stage:</strong> <span id="review-stage"></span></p>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-col">
                                <h4>Laboratory Values</h4>
                                <p><strong>Bilirubin:</strong> <span id="review-bilirubin"></span> mg/dL</p>
                                <p><strong>Cholesterol:</strong> <span id="review-cholesterol"></span> mg/dL</p>
                                <p><strong>Albumin:</strong> <span id="review-albumin"></span> g/dL</p>
                                <p><strong>Copper:</strong> <span id="review-copper"></span> µg/dL</p>
                                <p><strong>Alk_Phos:</strong> <span id="review-alk_phos"></span> U/L</p>
                                <p><strong>SGOT:</strong> <span id="review-sgot"></span> U/L</p>
                                <p><strong>Triglycerides:</strong> <span id="review-tryglicerides"></span> mg/dL</p>
                                <p><strong>Platelets:</strong> <span id="review-platelets"></span> per µL</p>
                                <p><strong>Prothrombin Time:</strong> <span id="review-prothrombin"></span> seconds</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Form Navigation -->
                    <div class="form-navigation">
                        <button type="button" id="prev-btn" class="btn btn-outline" style="display: none;">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        
                        <button type="button" id="next-btn" class="btn btn-primary">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                        
                        <button type="submit" id="submit-btn" class="btn btn-success" style="display: none;">
                            <i class="fas fa-check-circle"></i> Submit Prediction
                        </button>
                    </div>
                </form>
                
                <!-- Prediction Results -->
                {% if prediction %}
                <div class="alert alert-success">
                    <div class="alert-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="alert-content">
                        <div class="alert-title">Prediction Result</div>
                        <p>{{ prediction }}</p>
                    </div>
                </div>
                {% endif %}
                
                {% if error %}
                <div class="alert alert-danger">
                    <div class="alert-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="alert-content">
                        <div class="alert-title">Error</div>
                        <p>{{ error }}</p>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </main>
    
    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-column">
                <h3>HealthPredictor</h3>
                <p>Advanced medical prediction models powered by machine learning to assist healthcare professionals.</p>
            </div>
            
            <div class="footer-column">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li class="footer-link"><a href="{{ url_for('index') }}">Home</a></li>
                    <li class="footer-link"><a href="{{ url_for('liver_disease') }}">Liver Disease</a></li>
                    <li class="footer-link"><a href="{{ url_for('length_of_stay') }}">Length of Stay</a></li>
                    <li class="footer-link"><a href="{{ url_for('diabetes') }}">Diabetes</a></li>
                    <li class="footer-link"><a href="#">About</a></li>
                </ul>
            </div>
            
            <div class="footer-column">
                <h3>Resources</h3>
                <ul class="footer-links">
                    <li class="footer-link"><a href="#">Documentation</a></li>
                    <li class="footer-link"><a href="#">Research Papers</a></li>
                    <li class="footer-link"><a href="#">Model Accuracy</a></li>
                    <li class="footer-link"><a href="#">Data Sources</a></li>
                </ul>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2023 HealthPredictor. All rights reserved.</p>
        </div>
    </footer>
    
    <!-- Loading Overlay -->
    <div class="loading-overlay" style="display: none;">
        <div class="loader"></div>
        <p class="loading-text">Processing prediction...</p>
    </div>
    
    <script>
        // Mobile navigation toggle
        const mobileToggle = document.querySelector('.navbar-mobile-toggle');
        const mobileClose = document.querySelector('.navbar-mobile-close');
        const mobileNav = document.querySelector('.navbar-mobile');
        
        mobileToggle.addEventListener('click', () => {
            mobileNav.classList.add('active');
            document.body.style.overflow = 'hidden';
        });
        
        mobileClose.addEventListener('click', () => {
            mobileNav.classList.remove('active');
            document.body.style.overflow = '';
        });
        
        // Multi-step form
        const form = document.getElementById('liver-disease-form');
        const steps = document.querySelectorAll('.form-section');
        const stepIndicators = document.querySelectorAll('.form-step');
        const nextBtn = document.getElementById('next-btn');
        const prevBtn = document.getElementById('prev-btn');
        const submitBtn = document.getElementById('submit-btn');
        
        let currentStep = 0;
        
        // Show the current step
        function showStep(stepIndex) {
            steps.forEach((step, index) => {
                step.style.display = index === stepIndex ? 'block' : 'none';
            });
            
            stepIndicators.forEach((indicator, index) => {
                if (index < stepIndex) {
                    indicator.classList.add('completed');
                    indicator.classList.remove('active');
                } else if (index === stepIndex) {
                    indicator.classList.add('active');
                    indicator.classList.remove('completed');
                } else {
                    indicator.classList.remove('active', 'completed');
                }
            });
            
            // Show/hide buttons based on current step
            if (stepIndex === 0) {
                prevBtn.style.display = 'none';
            } else {
                prevBtn.style.display = 'block';
            }
            
            if (stepIndex === steps.length - 1) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'block';
                updateReviewContent();
            } else {
                nextBtn.style.display = 'block';
                submitBtn.style.display = 'none';
            }
            
            // Scroll to top of form
            window.scrollTo({ top: form.offsetTop - 100, behavior: 'smooth' });
        }
        
        // Validate current step
        function validateStep(stepIndex) {
            const currentStepElement = steps[stepIndex];
            const inputs = currentStepElement.querySelectorAll('input, select');
            let isValid = true;
            
            inputs.forEach(input => {
                if (input.hasAttribute('required') && !input.value) {
                    input.classList.add('is-invalid');
                    isValid = false;
                } else {
                    input.classList.remove('is-invalid');
                }
            });
            
            return isValid;
        }
        
        // Update review content
        function updateReviewContent() {
            document.getElementById('review-days').textContent = document.getElementById('n_days').value;
            document.getElementById('review-drug').textContent = document.getElementById('drug').options[document.getElementById('drug').selectedIndex].text;
            document.getElementById('review-age').textContent = document.getElementById('age').value;
            document.getElementById('review-sex').textContent = document.getElementById('sex').options[document.getElementById('sex').selectedIndex].text;
            document.getElementById('review-ascites').textContent = document.getElementById('ascites').options[document.getElementById('ascites').selectedIndex].text;
            document.getElementById('review-hepatomegaly').textContent = document.getElementById('hepatomegaly').options[document.getElementById('hepatomegaly').selectedIndex].text;
            document.getElementById('review-spiders').textContent = document.getElementById('spiders').options[document.getElementById('spiders').selectedIndex].text;
            document.getElementById('review-edema').textContent = document.getElementById('edema').options[document.getElementById('edema').selectedIndex].text;
            document.getElementById('review-stage').textContent = document.getElementById('stage').value;
            document.getElementById('review-bilirubin').textContent = document.getElementById('bilirubin').value;
            document.getElementById('review-cholesterol').textContent = document.getElementById('cholesterol').value;
            document.getElementById('review-albumin').textContent = document.getElementById('albumin').value;
            document.getElementById('review-copper').textContent = document.getElementById('copper').value;
            document.getElementById('review-alk_phos').textContent = document.getElementById('alk_phos').value;
            document.getElementById('review-sgot').textContent = document.getElementById('sgot').value;
            document.getElementById('review-tryglicerides').textContent = document.getElementById('tryglicerides').value;
            document.getElementById('review-platelets').textContent = document.getElementById('platelets').value;
            document.getElementById('review-prothrombin').textContent = document.getElementById('prothrombin').value;
        }
        
        // Next button click
        nextBtn.addEventListener('click', () => {
            if (validateStep(currentStep)) {
                currentStep++;
                showStep(currentStep);
            }
        });
        
        // Previous button click
        prevBtn.addEventListener('click', () => {
            currentStep--;
            showStep(currentStep);
        });
        
        // Form submission
        form.addEventListener('submit', (event) => {
            event.preventDefault();
            
            if (validateStep(currentStep)) {
                // Show loading overlay
                document.querySelector('.loading-overlay').style.display = 'flex';
                
                // Simulate delay for loading effect
                setTimeout(() => {
                    // Hide loading overlay
                    document.querySelector('.loading-overlay').style.display = 'none';
                    
                    // Submit the form
                    form.submit();
                }, 2000);
            }
        });
        
        // Initial step display
        showStep(currentStep);
    </script>
</body>
</html>